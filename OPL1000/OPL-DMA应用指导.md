# 		                                           OPL-DMA 应用指导书 



<img>![图片描述](https://raw.githubusercontent.com/june0854/june0854.github.io/%E5%9B%BE%E7%89%87/LOGO.bmp)

**版本V1.0** 

**版权©2019** 





##                                                                                                                                                                                                                            	     关于本手册

本手册介绍了OPL-DMA应用指导书产品参数，包含以下章节。 

|   章   | **标题** |          **内容**           |
| :----: | :------: | :-------------------------: |
| 第一章 | 产品简介 | 概述OPL-DMA的特点和功能应用 |
| 第二章 | 功能描述 |   描述模块功能及具体说明    |
| 第三章 | 电气特性 | 介绍模块的电气性能基本参数  |
| 第四章 | PCB设计  |   描述PCB layout注意事项    |







## 一、  产品简介														

OPL-DMA是深圳酷宅科技有限公司(简称：酷宅科技)开发低功耗智能门磁模块，主要包含触发预警功能、通过家庭网关接入，网络与云端数据交互功能、OTA功能，基于上述功能，用户可以实现APP远程接收门磁报警触发记录、设置模式、配置参数和查询状态等功能。  

主要应用领域：智能家居



   **产品特性**

- 支持11Mbps 802.11 b标准
- 支持STA模式
- Wi-Fi @ 2.4 GHz，支持WPA/WPA2安全模式

- 支持蓝牙5.0BLE标准，最大速率2Mbps
- 最大支持10dBm输出功率
- 支持OTA升级





## 二、功能描述

#### 2.1	模块功能

OPL-DMA模块作为门磁感应模块，主要用于检测指定门是否被打开，无论打开关闭都会将当前状态上报到服务器，APP可以实时收到消息通知。以下是功能说明：



#### 2.2	按键功能

**长按**：长按按键5秒进入蓝牙配网，在配网模式下，短按按键退出配网模式。

**短按**：短按按键使设备退出休眠状态，并且上报当前状态。



#### 2.3	数据上报

2.3.1 开关状态上报：（干簧管接到GPIO5，高电平触发）开门，关门都将触发状态上报。

2.3.1 电量信息上报:	触发开门关门时，检测电池电压，低于2.5V上报电量低。

2.3.2 在线信息上报：每一小时上报一次设备在线状态。

#### 2.4	状态指示灯

状态指示灯的闪烁特征是2秒为一个周期。高电平亮，低电平灭。状态有：

- 未连接路由：指示灯亮100毫秒，灭1900毫秒。表示设备没有进行配置，无法连接到路由

- 无法连接服务器：指示灯亮100毫秒，灭100毫秒，然后在亮100毫秒，灭1700毫秒。表示设备已经连接上无线路由器，但是无法连接到服务器（就是通常理解下的“无法上网”）。

- 蓝牙网状态：指示灯亮100毫秒，灭400毫秒。表示设备正处于蓝牙配网。

  ***注**：对按键按下时指示灯亮，松开指示灯灭。

   <div STYLE="page-break-after: always;"></div>  


## 三、电气特性

####      3.1	额定参数



                                      条件：VDD=3.3V±10%，GND=0V；室温25°C下测试。

| 类型         | 参数                                                        |
| ------------ | ----------------------------------------------------------- |
| 型号         | OPL-DMA                                                     |
| 主芯片       | OPL1000                                                     |
| 硬件接口     | GPIO,UART                                                   |
| 工作电压     | 1.8V~3.6V                                                   |
| 工作电流     | 峰值电流：200 mA<br />一般工作电流：16mA<br />休眠电流：3uA |
| 工作温度     | -20℃~ 70℃                                                   |
| 存储环境体   | 温度：-40 ℃ ~ 85℃，相对湿度：20%RH~80%RH                    |
| 尺寸大小     | 25.6mm×17.3mm×2.8mm                                         |
| 无线网络类型 | station/softAP/SoftAP+station                               |
| 安全机制     | WPA/WPA2                                                    |
| 加密类型     | AES-128/AES-256                                             |
| 固件升级     | 支持                                                        |

 <div STYLE="page-break-after: always;"></div>  

####      3.2	网络参数  

##### 3.2.1 wifi 参数：

​					条件：VDD=3.3V±10%，GND=0V；室温 25°C 下测试。 

|          类型           | 参数                              |
| :---------------------: | --------------------------------- |
|        无线标准         | IEEE 802.11 b                     |
|        频率范围         | 2.400 GHz - 2.483.5GHz            |
| 发射功率<br />（±2dBm） | 高电量：8 dBb<br />低电量：-5 dBm |
|       接收灵敏度        | -70 dBm                           |
|        天线类型         | PCB板天线                         |

##### 3.3.2 Bluetooth参数

​					条件：VDD=3.3V±10%，GND=0V；室温 25°C 下测试。 

|          类型           | 参数                   |
| :---------------------: | ---------------------- |
|        无线标准         | Bluetooth 5.0 BLE      |
|        频率范围         | 2.400 GHz - 2.483.5GHz |
| 发射功率<br />（±2dBm） | 低电量：-1dBm          |
|       接收灵敏度        | -70 dBm                |
|        天线类型         | PCB板天线              |

 <div STYLE="page-break-after: always;"></div>  

####      3.3	脚位排列顺序及封装信息

<img src="https://github.com/junlin-chen/img/raw/master/opl/%E6%AD%A3%E9%9D%A2.png" style="zoom: 67%;" />

                                                             模块示意图

<img src="https://github.com/junlin-chen/img/raw/master/opl/%E6%A8%A1%E5%9D%97%E6%AD%A3%E9%9D%A2%E5%BC%95%E8%84%9A.png" style="zoom:70%;" />

                                                   	      模块正面脚位图以及封装

 <div STYLE="page-break-after: always;"></div>  

####    3.4	管脚定义

                                                                             管脚定义及功能说明

| 管脚 | 名称         | 功能                                                         |
| ---- | ------------ | ------------------------------------------------------------ |
| 1    | RFOUT        | NC                                                           |
| 2    | GND          | GND                                                          |
| 3    | RST          | 外置复位信号：低电平有效，外部需上拉10K电阻到 3.3V，接 100nF电容到地 。 |
| 4    | EN           | 模块使能引脚，外部需上拉 10K 电阻到电源，接 100nF电容到地 。 |
| 5    | GPIOO/UTX    | NC                                                           |
| 6    | GPIO1/URX    | NC                                                           |
| 7    | GPIO2        | NC                                                           |
| 8    | GPIO3        | NC                                                           |
| 9    | KEY          | 按键输入，低电平有效。                                       |
| 10   | MAGNETIC_KEY | 干簧管输入，高电平有效。                                     |
| 11   | VCC          | 电源                                                         |
| 12   | GPIO6        | NC                                                           |
| 13   | GPIO23       | NC                                                           |
| 14   | ADC          | 电量采集端口。                                               |
| 15   | GPIO8        | NC                                                           |
| 16   | GPIO9        | NC                                                           |
| 17   | GPIO10       | NC                                                           |
| 18   | GPI011       | NC                                                           |
| 19   | GPIO16       | NC                                                           |
| 20   | GPIO17       | NC                                                           |
| 21   | GPI018       | NC                                                           |
| 22   | GPI019       | NC                                                           |
| 23   | GPIO20       | NC                                                           |
| 24   | WIFI_LED     | 模块指示灯，高电平亮；需要接LED灯串联1K限流电阻到地          |
| 25   | GPIO22       | NC                                                           |
| 26   | GND          | GND                                                          |



## 四、PCB设计

**PCB layout 与模块布局** ：

1. 在 PCB layout 时注意模块摆放位置，特别是模块的天线部分，尽可能远离干扰源： 磁性元件(如马达、电感、变压器等)、高频信号器件（如晶振、高频时钟信号等）。

2. 模块天线部分对应到PCB板的区域可做挖空处理。模块底部对应PCB板的上下层尽可能不走任何走线 。PCB布局示例：

   <img src="https://github.com/junlin-chen/img/raw/master/opl/%E5%A4%A9%E7%BA%BF.png" style="zoom: 67%;" />

3. 模块的VCC供电的电源引脚的电容尽可能靠近模块的引脚摆放。



 <div STYLE="page-break-after: always;"></div>  

![图片描述](https://raw.githubusercontent.com/june0854/june0854.github.io/%E5%9B%BE%E7%89%87/Zigbee%20%E7%89%88%E6%9D%83%E4%B8%93%E7%94%A8%20LOGO.bmp )